// Generated by CoffeeScript 1.4.0
var Message, onceIfString;

onceIfString = require('./decorators').onceIfString;

module.exports = Message = (function() {

  function Message(properties) {
    var composition, context, name, _fn, _i, _len, _ref,
      _this = this;
    if (properties == null) {
      properties = {};
    }
    context = {};
    composition = {
      context: ['title', 'description', 'origin', 'type', 'tenor']
    };
    _ref = composition.context;
    _fn = function(name) {
      return Object.defineProperty(_this, name, {
        get: function() {
          return context[name] || '';
        },
        set: onceIfString(function(value) {
          return context[name] = value;
        })
      });
    };
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      name = _ref[_i];
      _fn(name);
    }
    if (typeof properties === 'object') {
      try {
        for (name in properties) {
          this[name] = properties[name];
        }
      } catch (_error) {}
    }
    Object.defineProperty(this, 'context', {
      get: function() {
        var result, _j, _len1, _ref1;
        result = {};
        _ref1 = composition.context;
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          name = _ref1[_j];
          result[name] = context[name];
        }
        return result;
      }
    });
    Object.defineProperty(this, 'content', {
      get: function() {
        var result, _j, _len1, _ref1;
        result = {
          context: _this.context,
          payload: _this
        };
        _ref1 = composition.context;
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          name = _ref1[_j];
          result.context[name] = context[name];
        }
        return result;
      }
    });
  }

  return Message;

})();
